# CRUD Quiz

Use the solution to this afternoon's Property Tracker lab to answer the following questions. Please write your answers under each question, push the file to GitHub, and submit in the usual way.

## MVP Questions

In our Property Tracker application:

Q1. Where are we instantiating instances of the Property class?
Ans: Instance instantiation is when we call '.new' method of a class, so:
property.rb, l 71: properties = results.map {|property_hash| Property.new(property_hash)}
property.rb, l 95: found_property = Property.new(property_hash)

console.rb, l 6: property1 = Property.new({ ...
console.rb, l 15: property2 = Property.new({ ...
console.rb, l 24: property3 = Property.new({ ...


Q2. Where are we defining the SQL that enables us to save the ruby Property object into the database?
Ans: property.rb, l 18-29, in 'save' instance method


Q3. In console.rb, which lines modify the database?
Ans:
l 4 - Property.delete_all() - DELETE
l13 - property1.save() - INSERT
l22 - property2.save() - INSERT
l31 - property3.save() - INSERT
l33 - property1.delete() - DELETE

Q4. Why do we not define the id of a Property object at the point we instantiate it (‘new it up’)?
Ans: At this time, this value is unknown. id is a column added to a new row / used by the database as a Primary Key to guarantee uniqueness and the value for this column is generated at insert time and returned to us (if requested) by the database after the SQL INSERT statement has been executed.


Q5. Where and how do we assign the property id (that is generated by the database) to the ruby object?
Ans: the property id for the ruby object is set up in property.rb, l 32.
The property id is returned (from db.exec_prepared) after the INSERT (l 29: RETURNING id") and is returned in the form of an array of string hashes. In this case, there is only one element in the array, so we access this first element ( [0] ) and the actual id value can then be accessed by "id" string hash.


Q6. Why do we put a guard (an ‘if’ clause) on the @id attribute in the constructor?
Ans: This is to ensure that id is only initialized if id actually has a value.


Q7. Why are some of the CRUD actions represented by instance methods, and others, class methods?
Ans: Some methods are appropriate for specific objects (save, update, delete) as these actions are performed on these objects. Class methods are appropriate where a specific object is not the target of action.

Q8. What type of data structure is returned by db.exec() and db.exec_prepared(), and how do we index into it to pull out a desired attribute?
Ans: These statements return an array of hashes, with each element of the array / hash representing a single row for the database.
To access a desired attribute, we use the string hash.

Q9. Why do we use prepared statements when performing database operations?
Ans: This guards against sql injection attacks as the query and the data are sent to the database server separately.


## Extension Questions

Look at the `find_by_id` and `find_by_address` methods in the Property class.

Q10. What do they take in as their arguments?
Ans: Property.find takes an id (INT).
Property.find_by_address takes a string (VARCHAR).

Q11. What are their return values?
Ans: Property.find returns the array of hashes.
Property.find_by_address returns a newly instantiated Property object.
